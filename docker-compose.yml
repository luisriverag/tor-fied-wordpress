version: "2"

services:
  tor:
     image: goldy/tor-hidden-service
     build: .
     links:
          - wordpress

# Keep keys in volumes
     volumes:
          - "./keys:/var/lib/tor/hidden_service/"
     environment:
        # Set mapping ports
         WORDPRESS_PORTS: "80:80"
  db:
     image: mysql:5.7
     volumes:
          - "./.data/db:/var/lib/mysql"
     restart: always
     environment:
         MYSQL_ROOT_PASSWORD: wordpress
         MYSQL_DATABASE: wordpress
         MYSQL_USER: wordpress
         MYSQL_PASSWORD: wordpress

  wordpress:
     depends_on:
          - db
     image: wordpress:latest
     links:
          - db
     ports:
          - "80:80"
     restart: always
     environment:
         WORDPRESS_DB_HOST: db:3306
         WORDPRESS_DB_PASSWORD: wordpress
